{% extends "admin_base.html" %}
{% block title %}Appointments | MediCore{% endblock %}
{% block content %}
<section class="page-head">
  <h1 class="display-md">Appointments</h1>
  <a class="btn btn-primary" href="{{ url_for('appointments.booking_wizard') }}">Book Appointment</a>
</section>

<section class="card">
  <form method="get" class="toolbar">
    <input class="form-input" type="date" name="date" value="{{ request.args.get('date', '') }}">
    <select class="form-input" name="doctor_id">
      <option value="">All Doctors</option>
      {% for d in doctors %}
      <option value="{{ d.doctor_id }}" {% if request.args.get('doctor_id') == d.doctor_id|string %}selected{% endif %}>{{ d.name }}</option>
      {% endfor %}
    </select>
    <select class="form-input" name="status">
      <option value="">All Statuses</option>
      {% for s in ['pending','confirmed','in_progress','completed','cancelled'] %}
      <option value="{{ s }}" {% if request.args.get('status') == s %}selected{% endif %}>{{ s|replace('_',' ')|title }}</option>
      {% endfor %}
    </select>
    <button class="btn btn-ghost" type="submit">Filter</button>
  </form>

  <table class="data-table">
    <thead><tr><th>Date</th><th>Patient</th><th>Doctor</th><th>Status</th><th>Actions</th></tr></thead>
    <tbody>
      {% for a in appointments %}
      <tr>
        <td>{{ a.appt_date }} {{ a.appt_time }}</td>
        <td>{{ a.patient_name }}</td>
        <td>{{ a.doctor_name }}</td>
        <td><span class="status-badge status-{{ a.status|replace('_','-') }}">{{ a.status|replace('_',' ')|title }}</span></td>
        <td><a class="btn btn-ghost" href="{{ url_for('appointments.appointment_detail', appt_id=a.appt_id) }}">Open</a></td>
      </tr>
      {% else %}
      <tr><td colspan="5" class="text-muted">No appointments found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}
